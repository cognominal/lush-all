{"version":3,"file":"_server.ts-WC9EybQD.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/login/_server.ts.js"],"sourcesContent":["import { d as cookieSecureFor, W as WORKOS_OAUTH_STATE_COOKIE, a as WORKOS_PKCE_VERIFIER_COOKIE, f as WORKOS_RETURN_TO_COOKIE, w as workos, g as workosRedirectUri, c as workosClientId } from \"../../../chunks/workos.js\";\nimport crypto from \"node:crypto\";\nimport { redirect } from \"@sveltejs/kit\";\nfunction base64UrlEncode(buf) {\n  return Buffer.from(buf).toString(\"base64\").replaceAll(\"+\", \"-\").replaceAll(\"/\", \"_\").replaceAll(\"=\", \"\");\n}\nfunction randomBase64Url(bytes) {\n  return base64UrlEncode(crypto.randomBytes(bytes));\n}\nfunction pkceChallengeS256(verifier) {\n  const hash = crypto.createHash(\"sha256\").update(verifier).digest();\n  return base64UrlEncode(hash);\n}\nconst OAUTH_COOKIE_MAX_AGE_SECONDS = 10 * 60;\nconst GET = async ({ cookies, url }) => {\n  const state = randomBase64Url(32);\n  const codeVerifier = randomBase64Url(32);\n  const codeChallenge = pkceChallengeS256(codeVerifier);\n  const secure = cookieSecureFor(url);\n  cookies.set(WORKOS_OAUTH_STATE_COOKIE, state, {\n    httpOnly: true,\n    sameSite: \"lax\",\n    path: \"/\",\n    secure,\n    maxAge: OAUTH_COOKIE_MAX_AGE_SECONDS\n  });\n  cookies.set(WORKOS_PKCE_VERIFIER_COOKIE, codeVerifier, {\n    httpOnly: true,\n    sameSite: \"lax\",\n    path: \"/\",\n    secure,\n    maxAge: OAUTH_COOKIE_MAX_AGE_SECONDS\n  });\n  const returnTo = url.searchParams.get(\"returnTo\");\n  if (returnTo) {\n    cookies.set(WORKOS_RETURN_TO_COOKIE, returnTo, {\n      httpOnly: true,\n      sameSite: \"lax\",\n      path: \"/\",\n      secure,\n      maxAge: OAUTH_COOKIE_MAX_AGE_SECONDS\n    });\n  }\n  const authorizationUrl = await workos().userManagement.getAuthorizationUrl({\n    provider: \"GitHubOAuth\",\n    clientId: workosClientId(),\n    redirectUri: workosRedirectUri(),\n    state,\n    codeChallenge,\n    codeChallengeMethod: \"S256\",\n    screenHint: \"sign-in\"\n  });\n  throw redirect(302, authorizationUrl);\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;AAGA,SAAS,eAAe,CAAC,GAAG,EAAE;AAC9B,EAAE,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC;AAC1G;AACA,SAAS,eAAe,CAAC,KAAK,EAAE;AAChC,EAAE,OAAO,eAAe,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;AACnD;AACA,SAAS,iBAAiB,CAAC,QAAQ,EAAE;AACrC,EAAE,MAAM,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE;AACpE,EAAE,OAAO,eAAe,CAAC,IAAI,CAAC;AAC9B;AACA,MAAM,4BAA4B,GAAG,EAAE,GAAG,EAAE;AACvC,MAAC,GAAG,GAAG,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE,KAAK;AACxC,EAAE,MAAM,KAAK,GAAG,eAAe,CAAC,EAAE,CAAC;AACnC,EAAE,MAAM,YAAY,GAAG,eAAe,CAAC,EAAE,CAAC;AAC1C,EAAE,MAAM,aAAa,GAAG,iBAAiB,CAAC,YAAY,CAAC;AACvD,EAAE,MAAM,MAAM,GAAG,eAAe,CAAC,GAAG,CAAC;AACrC,EAAE,OAAO,CAAC,GAAG,CAAC,yBAAyB,EAAE,KAAK,EAAE;AAChD,IAAI,QAAQ,EAAE,IAAI;AAClB,IAAI,QAAQ,EAAE,KAAK;AACnB,IAAI,IAAI,EAAE,GAAG;AACb,IAAI,MAAM;AACV,IAAI,MAAM,EAAE;AACZ,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,EAAE;AACzD,IAAI,QAAQ,EAAE,IAAI;AAClB,IAAI,QAAQ,EAAE,KAAK;AACnB,IAAI,IAAI,EAAE,GAAG;AACb,IAAI,MAAM;AACV,IAAI,MAAM,EAAE;AACZ,GAAG,CAAC;AACJ,EAAE,MAAM,QAAQ,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,UAAU,CAAC;AACnD,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,OAAO,CAAC,GAAG,CAAC,uBAAuB,EAAE,QAAQ,EAAE;AACnD,MAAM,QAAQ,EAAE,IAAI;AACpB,MAAM,QAAQ,EAAE,KAAK;AACrB,MAAM,IAAI,EAAE,GAAG;AACf,MAAM,MAAM;AACZ,MAAM,MAAM,EAAE;AACd,KAAK,CAAC;AACN,EAAE;AACF,EAAE,MAAM,gBAAgB,GAAG,MAAM,MAAM,EAAE,CAAC,cAAc,CAAC,mBAAmB,CAAC;AAC7E,IAAI,QAAQ,EAAE,aAAa;AAC3B,IAAI,QAAQ,EAAE,cAAc,EAAE;AAC9B,IAAI,WAAW,EAAE,iBAAiB,EAAE;AACpC,IAAI,KAAK;AACT,IAAI,aAAa;AACjB,IAAI,mBAAmB,EAAE,MAAM;AAC/B,IAAI,UAAU,EAAE;AAChB,GAAG,CAAC;AACJ,EAAE,MAAM,QAAQ,CAAC,GAAG,EAAE,gBAAgB,CAAC;AACvC;;;;"}